<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2019.2 (Released June 5, 2019) -->
<HTML lang="EN">
<HEAD>
<TITLE>The effect of time domain sampling on the spectrum (Sampling
theorem)</TITLE>
<META NAME="description" CONTENT="The effect of time domain sampling on the spectrum (Sampling
theorem)">
<META NAME="keywords" CONTENT="digital_signal_processing">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2019.2">

<LINK REL="STYLESHEET" HREF="digital_signal_processing.css">

<LINK REL="next" HREF="node41.html">
<LINK REL="previous" HREF="node39.html">
<LINK REL="next" HREF="node41.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node41.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node38.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node39.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html292"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A
 HREF="node41.html">Discrete Fourier Transform (DFT)</A>
<B> Up:</B> <A
 HREF="node38.html">Sampled time and/or frequency</A>
<B> Previous:</B> <A
 HREF="node39.html">Discrete time Fourier Transform</A>
 &nbsp; <B>  <A ID="tex2html293"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A ID="SECTION00062200000000000000">
The effect of time domain sampling on the spectrum (Sampling
theorem)</A>
</H3>

<DIV class="CENTER"><A ID="periodic_ny"></A><A ID="1644"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 5:</STRONG>
Effect of sampling on the spectrum.
</CAPTION>
<TR><TD>
<DIV class="CENTER">
<IMG STYLE=""
 SRC="img119.svg"
 ALT="\includegraphics[width=0.75\textwidth]{periodic_ny}">

</DIV></TD></TR>
</TABLE>
</DIV>
What effect has time domain sampling on the frequency spectrum<A ID="tex2html7"
  HREF="footnode.html#foot1645"><SUP><SPAN CLASS="arabic">2</SPAN></SUP></A>? Imagine we
have an analog spectrum <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img120.svg"
 ALT="$X_a(F)$"></SPAN> from a continuous signal <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img91.svg"
 ALT="$x(t)$"></SPAN>. We want
to know how the spectrum <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img90.svg"
 ALT="$X(F)$"></SPAN> of the discrete signal <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img6.svg"
 ALT="$x(n)$"></SPAN> looks like.

<DIV class="equation">

<!-- MATH
 \begin{equation}
X(F) \Leftrightarrow X_a(F)
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img121.svg"
 ALT="$\displaystyle X(F) \Leftrightarrow X_a(F)
$"> 

(<SPAN CLASS="arabic">40</SPAN>)
</DIV>
The signal is represented by <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img6.svg"
 ALT="$x(n)$"></SPAN> so that
we can equate the Fourier transforms of the sampled spectrum <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img90.svg"
 ALT="$X(F)$"></SPAN> and
of the analogue spectrum <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img120.svg"
 ALT="$X_a(F)$"></SPAN>. 

<DIV class="equation">

<!-- MATH
 \begin{equation}
\int_{-0.5}^{0.5} \underbrace{X(f)}_{\mbox{sampled}} e^{j 2 \pi f n} df =
\int_{-\infty}^{+\infty} \underbrace{X_a(F)}_{\mbox{cont}} e^{j 2\pi n F/F_s} dF
\end{equation}
 -->
 &nbsp;  <A ID="sampl_idea"></A><IMG STYLE="height: 7.59ex; vertical-align: -4.51ex; " SRC="img122.svg"
 ALT="$\displaystyle \int_{-0.5}^{0.5} \underbrace{X(f)}_{\mbox{sampled}} e^{j 2 \pi f...
...nt_{-\infty}^{+\infty} \underbrace{X_a(F)}_{\mbox{cont}} e^{j 2\pi n F/F_s} dF
$"> 

(<SPAN CLASS="arabic">41</SPAN>)
</DIV>
Obviously <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img123.svg"
 ALT="$X(f)$"></SPAN> must be different to accommodate the different integration
ranges. The trick is now to divide the integral on the right hand side 
of Eq.&nbsp;<A HREF="#sampl_idea">41</A> 
into chunks to make it compatible to the range on the left hand
hand side.

<P>
Remember that the normalised frequency is <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img124.svg"
 ALT="$f=F/F_s$"></SPAN> which allows us
to change the integration to analogue frequency on both sides:

<DIV class="equation">

<!-- MATH
 \begin{equation}
\frac{1}{F_s} \int_{-F_s/2}^{F_s/2} X(\frac{F}{F_s}) e^{j 2 \pi n F/F_s} dF
=
\int_{-\infty}^{+\infty} X_a(F) e^{j 2\pi n F/F_s} dF
\end{equation}
 -->
 &nbsp;  <A ID="sampl_ana_dig"></A><IMG STYLE="height: 5.33ex; vertical-align: -2.08ex; " SRC="img125.svg"
 ALT="$\displaystyle \frac{1}{F_s} \int_{-F_s/2}^{F_s/2} X(\frac{F}{F_s}) e^{j 2 \pi n F/F_s} dF
=
\int_{-\infty}^{+\infty} X_a(F) e^{j 2\pi n F/F_s} dF
$"> 

(<SPAN CLASS="arabic">42</SPAN>)
</DIV>
and now we divide the right hand side into chunks of <SPAN CLASS="MATH"><IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img5.svg"
 ALT="$F_s$"></SPAN> which corresponds
to the integration range on the left hand side.
<BR>
<DIV ALIGN="CENTER">

<!-- MATH
 \begin{eqnarray}
\int_{-\infty}^{+\infty} X_a(F) e^{j 2\pi n \frac{F}{F_s}} dF
& = &
\sum_{k=-\infty}^{\infty} \int_{-\frac{1}{2} F_s + k F_s}^{+\frac{1}{2} F_s + k F_s} X_a(F) e^{j2\pi n \frac{F}{F_s}} dF \\
& = &
\sum_{k=-\infty}^{\infty} \int_{-\frac{1}{2} F_s}^{+\frac{1}{2} F_s} X_a(F-k F_s) \underbrace{e^{j2\pi n\frac{F}{F_s}}}_{k F_s \mbox{ omit.}} dF \\
& = &
\int_{-\frac{1}{2} F_s}^{+\frac{1}{2} F_s} \underbrace{\sum_{k=-\infty}^{\infty} X_a(F-k F_s)}_{=X(F) \mbox{ of Eq.~\ref{sampl_ana_dig}}} e^{j2\pi n\frac{F}{F_s}} dF
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG STYLE="height: 4.90ex; vertical-align: -1.86ex; " SRC="img126.svg"
 ALT="$\displaystyle \int_{-\infty}^{+\infty} X_a(F) e^{j 2\pi n \frac{F}{F_s}} dF$"></TD>
<TD ALIGN="CENTER" NOWRAP><IMG STYLE="height: 1.00ex; vertical-align: -0.09ex; " SRC="img82.svg"
 ALT="$\textstyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG STYLE="height: 6.19ex; vertical-align: -2.73ex; " SRC="img127.svg"
 ALT="$\displaystyle \sum_{k=-\infty}^{\infty} \int_{-\frac{1}{2} F_s + k F_s}^{+\frac{1}{2} F_s + k F_s} X_a(F) e^{j2\pi n \frac{F}{F_s}} dF$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">43</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD ALIGN="CENTER" NOWRAP><IMG STYLE="height: 1.00ex; vertical-align: -0.09ex; " SRC="img82.svg"
 ALT="$\textstyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG STYLE="height: 7.11ex; vertical-align: -3.66ex; " SRC="img128.svg"
 ALT="$\displaystyle \sum_{k=-\infty}^{\infty} \int_{-\frac{1}{2} F_s}^{+\frac{1}{2} F_s} X_a(F-k F_s) \underbrace{e^{j2\pi n\frac{F}{F_s}}}_{k F_s \mbox{ omit.}} dF$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">44</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD ALIGN="CENTER" NOWRAP><IMG STYLE="height: 1.00ex; vertical-align: -0.09ex; " SRC="img82.svg"
 ALT="$\textstyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG STYLE="height: 10.03ex; vertical-align: -6.58ex; " SRC="img129.svg"
 ALT="% latex2html id marker 6130
$\displaystyle \int_{-\frac{1}{2} F_s}^{+\frac{1}{2...
...-k F_s)}_{=X(F) \mbox{ of Eq.~\ref{sampl_ana_dig}}} e^{j2\pi n\frac{F}{F_s}} dF$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">45</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
This gives us now an equation for the sampled spectrum:
<BR>
<DIV ALIGN="CENTER">

<!-- MATH
 \begin{eqnarray}
X(F/F_s) & = & F_s \sum_{k=-\infty}^{\infty} X_a(F-kF_s) \\
X(f) & = & F_s \sum_{k=-\infty}^{\infty} X_a[(f-k)F_s]
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img130.svg"
 ALT="$\displaystyle X(F/F_s)$"></TD>
<TD ALIGN="CENTER" NOWRAP><IMG STYLE="height: 1.00ex; vertical-align: -0.09ex; " SRC="img82.svg"
 ALT="$\textstyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG STYLE="height: 6.07ex; vertical-align: -2.73ex; " SRC="img131.svg"
 ALT="$\displaystyle F_s \sum_{k=-\infty}^{\infty} X_a(F-kF_s)$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">46</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img132.svg"
 ALT="$\displaystyle X(f)$"></TD>
<TD ALIGN="CENTER" NOWRAP><IMG STYLE="height: 1.00ex; vertical-align: -0.09ex; " SRC="img82.svg"
 ALT="$\textstyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG STYLE="height: 6.07ex; vertical-align: -2.73ex; " SRC="img133.svg"
 ALT="$\displaystyle F_s \sum_{k=-\infty}^{\infty} X_a[(f-k)F_s]$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">47</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
This equation can now be interpreted. In order to get the sampled
spectrum <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img90.svg"
 ALT="$X(F)$"></SPAN> we need to make copies of the analog spectrum
<SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img120.svg"
 ALT="$X_a(F)$"></SPAN> and place these copies at multiples of the sampling rate
<SPAN CLASS="MATH"><IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img5.svg"
 ALT="$F_s$"></SPAN> (see Fig.&nbsp;<A HREF="#periodic_ny">5</A>). This illustrates also the
<SPAN  CLASS="textsl">sampling theorem</SPAN>: if the bandwidth of the spectrum is wider
than <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img134.svg"
 ALT="$F_s/2$"></SPAN> then the copies of the analogue spectrum will overlap and
reconstruction would be impossible. This is called aliasing. Note that
it is not necessary bad that the spectrum of the analogue signal lies
within the range of the so called &ldquo;base band&rdquo; <!-- MATH
 $-F/2 \ldots F/2$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img135.svg"
 ALT="$-F/2 \ldots F/2$"></SPAN>. It
can also lie in another frequency range further up, for example <!-- MATH
 $-F/2
+ 34 \ldots F/2 +34$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img136.svg"
 ALT="$-F/2
+ 34 \ldots F/2 +34$"></SPAN> as long as the
<SPAN  CLASS="textsl">bandwidth</SPAN> does not exceed <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img134.svg"
 ALT="$F_s/2$"></SPAN>. If it is placed further up
it will automatically show up in the baseband <!-- MATH
 $-F/2 \ldots F/2$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img135.svg"
 ALT="$-F/2 \ldots F/2$"></SPAN> which
is called &ldquo;fold down&rdquo;. This can be used for our purposes if we
want to down mix a signal.

<P>

<DIV class="CENTER"><A ID="fold_down"></A><A ID="1662"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 6:</STRONG>
Mapping of frequencies in the analogue domain (<SPAN CLASS="MATH"><IMG STYLE="height: 1.72ex; vertical-align: -0.09ex; " SRC="img3.svg"
 ALT="$F$"></SPAN>)
and sampled domain (<SPAN CLASS="MATH"><IMG STYLE="height: 2.18ex; vertical-align: -0.53ex; " SRC="img4.svg"
 ALT="$f$"></SPAN>). <SPAN CLASS="MATH"><IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img5.svg"
 ALT="$F_s$"></SPAN> is the sampling rate.
</CAPTION>
<TR><TD>
<DIV class="CENTER">
<IMG STYLE=""
 SRC="img137.svg"
 ALT="\includegraphics[width=\textwidth]{fold_down}">

</DIV></TD></TR>
</TABLE>
</DIV>

<P>
With the insight from these equations we can create
a plot of how analogue frequencies map onto sampled frequencies.
Fig&nbsp;<A HREF="#fold_down">6</A> shows how the analogue frequencies <!-- MATH
 $F_\textrm{analogue}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.94ex; vertical-align: -1.32ex; " SRC="img138.svg"
 ALT="$F_\textrm{analogue}$"></SPAN>
map on the normalised frequencies <!-- MATH
 $f_\textrm{sampled}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.96ex; vertical-align: -1.32ex; " SRC="img139.svg"
 ALT="$f_\textrm{sampled}$"></SPAN>.
As long as the analogue frequencies are below <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img134.svg"
 ALT="$F_s/2$"></SPAN> the mapping
is as usual as shown in Fig&nbsp;<A HREF="#fold_down">6</A>A. 
Between <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img134.svg"
 ALT="$F_s/2$"></SPAN> and <SPAN CLASS="MATH"><IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img5.svg"
 ALT="$F_s$"></SPAN> we have an inverse mapping:
an increase in analogue frequency causes a decrease in frequencies.
Then, from <SPAN CLASS="MATH"><IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img5.svg"
 ALT="$F_s$"></SPAN> we have again an increase in frequencies starting
from DC. So,
in general if we keep a bandlimited signal within one of these
slopes (for example from <!-- MATH
 $F_s \ldots F_s + 1/2 F_s$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img140.svg"
 ALT="$F_s \ldots F_s + 1/2 F_s$"></SPAN> as 
shown in Fig&nbsp;<A HREF="#fold_down">6</A>B) then we can
reproduce the signal.

<P>
This leads us to the generalised Nyquist theorem: if a bandpass
filtered signal has a bandwidth of <SPAN CLASS="MATH"><IMG STYLE="height: 1.72ex; vertical-align: -0.09ex; " SRC="img60.svg"
 ALT="$B$"></SPAN> then the minimum sampling
frequency is <SPAN CLASS="MATH"><IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img141.svg"
 ALT="$F_s = 2B$"></SPAN>.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node41.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node38.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node39.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html292"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A
 HREF="node41.html">Discrete Fourier Transform (DFT)</A>
<B> Up:</B> <A
 HREF="node38.html">Sampled time and/or frequency</A>
<B> Previous:</B> <A
 HREF="node39.html">Discrete time Fourier Transform</A>
 &nbsp; <B>  <A ID="tex2html293"
  HREF="node1.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->
<ADDRESS>
<p><br /><a href="https://github.com/berndporr/digital_signal_processing">github / contact</a><br /></p>
</ADDRESS>
</BODY>
</HTML>
