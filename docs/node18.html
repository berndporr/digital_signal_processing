<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2019.2 (Released June 5, 2019) -->
<HTML lang="EN">
<HEAD>
<TITLE>Sampling</TITLE>
<meta name="google-site-verification" content="dHOmN66WitxgD2yFMjrDq8aatlUBmj2hBDQL6v7sU30" />
<META NAME="description" CONTENT="Digital Signal Processing">
<META NAME="keywords" CONTENT="DSP, Python, Digital, Signals, Engineering, Computer science">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META CHARSET="UTF-8">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2019.2">

<LINK REL="STYLESHEET" HREF="digital_signal_processing.css">

<LINK REL="next" HREF="node19.html">
<LINK REL="previous" HREF="node17.html">
<LINK REL="next" HREF="node19.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node19.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node17.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node17.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html226"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A
 HREF="node19.html">Quantisation</A>
<B> Up:</B> <A
 HREF="node17.html">Signal conversion</A>
<B> Previous:</B> <A
 HREF="node17.html">Signal conversion</A>
 &nbsp; <B>  <A ID="tex2html227"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A ID="tex2html228"
  HREF="node18.html#SECTION00051100000000000000">Normalised frequency</A>
<LI><A ID="tex2html229"
  HREF="node18.html#SECTION00051200000000000000">Nyquist frequency</A>
<LI><A ID="tex2html230"
  HREF="node18.html#SECTION00051300000000000000">Sampling theorem</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A ID="SECTION00051000000000000000">
Sampling</A>
</H2>
The analogue signal <SPAN CLASS="MATH"><IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img34.svg"
 ALT="$X_a$"></SPAN> is sampled at intervals <SPAN CLASS="MATH"><IMG STYLE="height: 1.72ex; vertical-align: -0.09ex; " SRC="img30.svg"
 ALT="$T$"></SPAN> to get
the sampled signal <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img35.svg"
 ALT="$X(n)$"></SPAN>.

<DIV class="equation">

<!-- MATH
 \begin{equation}
x(n) = x_{a}(nT),  \qquad -\infty < n < +\infty
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img36.svg"
 ALT="$\displaystyle x(n) = x_{a}(nT), \qquad -\infty &lt; n &lt; +\infty
$"> 

(<SPAN CLASS="arabic">2</SPAN>)
</DIV>

<P>

<H3><A ID="SECTION00051100000000000000">
Normalised frequency</A>
</H3>
Note that the sampling frequency

<DIV class="equation">

<!-- MATH
 \begin{equation}
F_{s} = \frac{1}{T_s}
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 5.02ex; vertical-align: -1.97ex; " SRC="img37.svg"
 ALT="$\displaystyle F_{s} = \frac{1}{T_s}
$"> 

(<SPAN CLASS="arabic">3</SPAN>)
</DIV>
is lost and needs to be stored additionally so that the analogue
signal can be reconstructed:

<DIV class="equation">

<!-- MATH
 \begin{equation}
x_{a}(t) = x_{a}(nT) = x_{a}(\frac{n}{F_{s}})
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 4.54ex; vertical-align: -1.97ex; " SRC="img38.svg"
 ALT="$\displaystyle x_{a}(t) = x_{a}(nT) = x_{a}(\frac{n}{F_{s}})
$"> 

(<SPAN CLASS="arabic">4</SPAN>)
</DIV>

<P>

<DIV class="CENTER"><A ID="max_sampl"></A><A ID="1628"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 1:</STRONG>
Maximum frequency of a sampled signal is half the
normalised frequency.
</CAPTION>
<TR><TD>
<DIV class="CENTER">
<IMG STYLE=""
 SRC="img39.svg"
 ALT="\includegraphics[width=0.75\textwidth]{max_sampl}">

</DIV></TD></TR>
</TABLE>
</DIV>

<P>
What is the frequency range of our digital signal? What is
the maximum frequency in digital terms? Fig&nbsp;<A HREF="#max_sampl">1</A> shows that the
max frequency is <SPAN CLASS="MATH"><IMG STYLE="height: 1.63ex; vertical-align: -0.09ex; " SRC="img40.svg"
 ALT="$0.5$"></SPAN> because we need two samples to
represent a &ldquo;wave&rdquo;. The frequency range <SPAN CLASS="MATH"><IMG STYLE="height: 1.63ex; vertical-align: -0.09ex; " SRC="img41.svg"
 ALT="$0\ldots 0.5$"></SPAN>
is called the <SPAN  CLASS="textsl">normalised frequency</SPAN> range. What is the relation
between normalised frequency and sampling rate?

<P>
Let's have a look at the analog signal <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img42.svg"
 ALT="$X_{a}(t)$"></SPAN> with the frequency <SPAN CLASS="MATH"><IMG STYLE="height: 1.72ex; vertical-align: -0.09ex; " SRC="img3.svg"
 ALT="$F$"></SPAN>:

<DIV class="equation">

<!-- MATH
 \begin{equation}
x_{a}(t) = A\cos (2\pi F t)
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img43.svg"
 ALT="$\displaystyle x_{a}(t) = A\cos (2\pi F t)
$"> 

(<SPAN CLASS="arabic">5</SPAN>)
</DIV>
and we sample it only at:

<DIV class="equation">

<!-- MATH
 \begin{equation}
t = n/F_s
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img44.svg"
 ALT="$\displaystyle t = n/F_s
$"> 

(<SPAN CLASS="arabic">6</SPAN>)
</DIV>
Then the digital signal is:

<DIV class="equation">

<!-- MATH
 \begin{equation}
x_{a}(n) = A \cos (2 \pi F/F_s n)
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img45.svg"
 ALT="$\displaystyle x_{a}(n) = A \cos (2 \pi F/F_s n)
$"> 

(<SPAN CLASS="arabic">7</SPAN>)
</DIV>

<P>
Now, we can define the normalised frequency as:

<DIV class="equation">

<!-- MATH
 \begin{equation}
\mbox{Normalised frequency:} \qquad f =  \frac {F}{F_s}
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 5.11ex; vertical-align: -1.97ex; " SRC="img46.svg"
 ALT="$\displaystyle \mbox{Normalised frequency:} \qquad f = \frac {F}{F_s}
$"> 

(<SPAN CLASS="arabic">8</SPAN>)
</DIV>
which has its max value at <SPAN CLASS="MATH"><IMG STYLE="height: 1.63ex; vertical-align: -0.09ex; " SRC="img40.svg"
 ALT="$0.5$"></SPAN> which represents one period of
a sine wave within two samples<A ID="tex2html3"
  HREF="footnode.html#foot1774"><SUP><SPAN CLASS="arabic">1</SPAN></SUP></A>
<P>

<H3><A ID="SECTION00051200000000000000">
Nyquist frequency</A>
</H3>
Recall that the max value for the normalised frequency <SPAN CLASS="MATH"><IMG STYLE="height: 2.18ex; vertical-align: -0.53ex; " SRC="img4.svg"
 ALT="$f$"></SPAN> is <SPAN CLASS="MATH"><IMG STYLE="height: 1.63ex; vertical-align: -0.09ex; " SRC="img40.svg"
 ALT="$0.5$"></SPAN>
and that:

<DIV class="equation">

<!-- MATH
 \begin{equation}
x_{a}(n) = A \cos (2 \pi n f)
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img50.svg"
 ALT="$\displaystyle x_{a}(n) = A \cos (2 \pi n f)
$"> 

(<SPAN CLASS="arabic">9</SPAN>)
</DIV>
with <SPAN CLASS="MATH"><IMG STYLE="height: 1.15ex; vertical-align: -0.09ex; " SRC="img51.svg"
 ALT="$n$"></SPAN> as an integer because
we are sampling.

<P>
What happens above <SPAN CLASS="MATH"><IMG STYLE="height: 2.18ex; vertical-align: -0.53ex; " SRC="img52.svg"
 ALT="$f&gt;0.5$"></SPAN>? Imagine <SPAN CLASS="MATH"><IMG STYLE="height: 2.18ex; vertical-align: -0.53ex; " SRC="img53.svg"
 ALT="$f = 1$"></SPAN>

<DIV class="equation">

<!-- MATH
 \begin{equation}
x_{a}(n) = \cos (2 \pi n) = 1 \qquad f=1
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img54.svg"
 ALT="$\displaystyle x_{a}(n) = \cos (2 \pi n) = 1 \qquad f=1
$"> 

(<SPAN CLASS="arabic">10</SPAN>)
</DIV>
which gives us DC or zero frequency. The same is true for
<!-- MATH
 $f = 2, 3, 4, \ldots$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.18ex; vertical-align: -0.53ex; " SRC="img55.svg"
 ALT="$f = 2, 3, 4, \ldots$"></SPAN>. We see that above <SPAN CLASS="MATH"><IMG STYLE="height: 2.18ex; vertical-align: -0.53ex; " SRC="img49.svg"
 ALT="$f=0.5$"></SPAN> we never
get higher frequencies. Instead they will always stay between
<SPAN CLASS="MATH"><IMG STYLE="height: 1.63ex; vertical-align: -0.09ex; " SRC="img41.svg"
 ALT="$0\ldots 0.5$"></SPAN> for the simple reason that it is not possible
to represent higher frequencies. This will be discussed later
in greater detail.

<P>
The ratio <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img56.svg"
 ALT="$F/F_s$"></SPAN> must  be lower than <SPAN CLASS="MATH"><IMG STYLE="height: 1.63ex; vertical-align: -0.09ex; " SRC="img40.svg"
 ALT="$0.5$"></SPAN> to avoid ambiguity
or in other words the maximum frequency in a signal must be lower than 
<!-- MATH
 $\frac{1}{2} F_s$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.81ex; vertical-align: -0.87ex; " SRC="img57.svg"
 ALT="$\frac{1}{2} F_s$"></SPAN>. This is the Nyquist frequency.

<P>
If there are higher frequencies in the signal then these frequencies
are &ldquo;folded down&rdquo; into the frequency range of <!-- MATH
 $0\ldots \frac{1}{2} F_s$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.81ex; vertical-align: -0.87ex; " SRC="img58.svg"
 ALT="$0\ldots \frac{1}{2} F_s$"></SPAN>
and creating an alias of its original frequency in the so called
&ldquo;baseband&rdquo; (<SPAN CLASS="MATH"><IMG STYLE="height: 2.18ex; vertical-align: -0.53ex; " SRC="img59.svg"
 ALT="$f=0\ldots 0.5$"></SPAN>). As long as the alias is not overlapping
with other signal components in the baseband this can be used to
downmix a signal. This leads to the general definition of the
sampling theorem which states that the bandwidth <SPAN CLASS="MATH"><IMG STYLE="height: 1.72ex; vertical-align: -0.09ex; " SRC="img60.svg"
 ALT="$B$"></SPAN> of the input signal
must be half of the sampling rate <SPAN CLASS="MATH"><IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img5.svg"
 ALT="$F_s$"></SPAN>:

<DIV class="equation">

<!-- MATH
 \begin{equation}
B < \frac{1}{2}F_s
\end{equation}
 -->
 &nbsp;  <A ID="samplingTheorem"></A><IMG STYLE="height: 4.69ex; vertical-align: -1.64ex; " SRC="img61.svg"
 ALT="$\displaystyle B &lt; \frac{1}{2}F_s
$"> 

(<SPAN CLASS="arabic">11</SPAN>)
</DIV>
The frequency <!-- MATH
 $\frac{1}{2}F_s$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.81ex; vertical-align: -0.87ex; " SRC="img57.svg"
 ALT="$\frac{1}{2} F_s$"></SPAN> is called the Nyquist frequency.

<P>

<DIV class="CENTER"><A ID="anti_alias"></A><A ID="1632"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 2:</STRONG>
Anti alias filtering. A) with a lowpass filter. B)
with a sigma delta converter with very high sampling rate.
</CAPTION>
<TR><TD>
<DIV class="CENTER">
<IMG STYLE=""
 SRC="img62.svg"
 ALT="\includegraphics[width=0.75\textwidth]{anti_alias}">

</DIV></TD></TR>
</TABLE>
</DIV>

<P>
What do we do if the signal contains frequencies above 
<!-- MATH
 $\frac{1}{2} F_s$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.81ex; vertical-align: -0.87ex; " SRC="img57.svg"
 ALT="$\frac{1}{2} F_s$"></SPAN>? There are two ways to tackle this problem:
The classical way is
to use a lowpass filter (see Fig.&nbsp;<A HREF="#anti_alias">2</A>A) which filters
out all frequencies above the Nyquist frequency. However this
might be difficult in applications with high resolution A/D converters.
Alternatively one can use a much higher sampling rate to avoid
aliasing. This is the idea of the sigma delta converter
which operates at sampling rates hundred times higher than the
Nyquist frequency.

<P>

<H3><A ID="SECTION00051300000000000000">
Sampling theorem</A>
</H3>
Is it possible to reconstruct an analogue signal from a digital signal
which contains only frequencies below the Nyquist frequency?

<P>

<DIV class="equation">

<!-- MATH
 \begin{equation}
F_s > 2 F_{\mbox{max}}
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img63.svg"
 ALT="$\displaystyle F_s &gt; 2 F_{\mbox{max}}
$"> 

(<SPAN CLASS="arabic">12</SPAN>)
</DIV>
where <!-- MATH
 $F_{\mbox{max}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img64.svg"
 ALT="$F_{\mbox{max}}$"></SPAN> is max frequency in the signal which we
represent by sine waves:

<DIV class="equation">

<!-- MATH
 \begin{equation}
x_{a}(t) = \sum_{i=1}^{n} A_i \cos (2 \pi F_{i}t  + \Theta_{i})
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 5.87ex; vertical-align: -2.52ex; " SRC="img65.svg"
 ALT="$\displaystyle x_{a}(t) = \sum_{i=1}^{n} A_i \cos (2 \pi F_{i}t + \Theta_{i})
$"> 

(<SPAN CLASS="arabic">13</SPAN>)
</DIV>

<P>
The analogue signal <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img66.svg"
 ALT="$x_{a}(t)$"></SPAN> can be completely reconstructed if:

<DIV class="equation">

<!-- MATH
 \begin{equation}
g(t) = \frac{\sin 2\pi Bt}{2 \pi Bt}
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 4.77ex; vertical-align: -1.64ex; " SRC="img67.svg"
 ALT="$\displaystyle g(t) = \frac{\sin 2\pi Bt}{2 \pi Bt}
$"> 

(<SPAN CLASS="arabic">14</SPAN>)
</DIV>

<P>
with

<DIV class="equation">

<!-- MATH
 \begin{equation}
B = F_{\mbox{max}}
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 2.06ex; vertical-align: -0.43ex; " SRC="img68.svg"
 ALT="$\displaystyle B = F_{\mbox{max}}
$"> 

(<SPAN CLASS="arabic">15</SPAN>)
</DIV>

<P>

<DIV class="equation">

<!-- MATH
 \begin{equation}
x_{a}(t) = \sum_{h= -a}^{a}x_{a}(\frac{n}{F_s})g(t - \frac{h}{F_s})
\end{equation}
 -->
 &nbsp;  <IMG STYLE="height: 6.07ex; vertical-align: -2.73ex; " SRC="img69.svg"
 ALT="$\displaystyle x_{a}(t) = \sum_{h= -a}^{a}x_{a}(\frac{n}{F_s})g(t - \frac{h}{F_s})
$"> 

(<SPAN CLASS="arabic">16</SPAN>)
</DIV>

<P>
The problem is that <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img70.svg"
 ALT="$g(t)$"></SPAN> runs from negative time to positive time
and as we see later is a-causal so that this cannot be implemented
for real but approximations of <SPAN CLASS="MATH"><IMG STYLE="height: 2.43ex; vertical-align: -0.66ex; " SRC="img70.svg"
 ALT="$g(t)$"></SPAN> are possible and are analogue
lowpass filters which smooth out the step like outout of an digital
to analogue converter.

<P>

<DIV CLASS="navigation"><HR></DIV>
<!--End of Navigation Panel-->
<p><a href="https://github.com/berndporr/digital_signal_processing">github / contact</a></p><P><A REL="license" HREF="http://creativecommons.org/licenses/by-sa/4.0/"><IMG ALT="Creative Commons License" SRC="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></A></P>
</BODY>
</HTML>
